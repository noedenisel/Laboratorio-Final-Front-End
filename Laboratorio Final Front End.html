<!DOCTYPE html>
<html lang="ES">
    <head>
        <meta charset="utf-8" />
        <title>Laboratorio Front End</title>
        <link rel= "stylesheet" type= "text/css" href="Laboratorio Front End.css"/>
    </head>
    <body>
        <form action="./procesaformulario.php" id= "form">
        <h1>Formulario Información Alta Telefónica</h1>
        <fieldset class= "fieldset">
            <legend class= "legend">Datos Personales</legend>
            <label for='nombre'>Nombre:</label>
            <input type="text" id="nombre" value="" maxlength="30" class="campo"/><br/>
            <label for="apellidos">Apellidos:</label>
            <input type="text" id="apellidos" value= "" maxlength="60" class="campo"/><br/>
            <label for="direccion">Dirección:</label>
            <input type="text" id="direccion" value="" maxlength="60"class = "campo"/><br/>
            <label for="codigopostal" >Código Postal:</label> 
            <input type="text" id="codigopostal" pattern="[0-9]+" value="" maxlength="5" class= "campo"/> </br> 
            <label for="provincia">Provincia:</label>
            <input type="text" id="provincia" class= "campo" pattern="[A-Za-z]"/> </br>
            <span id= "salidaprovincia"></span> 
        </fieldset>
        <fieldset class= "fieldset">
            <legend class= "legend">Tipo de Contratación</legend>
            <input type="radio" name="contratacion" value="0" checked=checked> Nueva Contratación <input type="radio" name="contratacion" value="1">Portabilidad <input type="radio" name="contratacion" value="2">Cambio de Contrato <br/>
            <p>Elija la compañia actual <select name="compañia actual"><option>Movistar</option><option>Orange</option><Option>Vodafone</Option><option> No tengo ninguna compañia </option></select> En caso de portabilidad, elija la nueva compañia:<select name=portabilidad><option>Movistar</option><option>Orange</option><option>Vodafone</option><Option>Yoigo</Option></select></p>
        </fieldset>
        <fieldset class= "fieldset">
            <legend class= "legend">Datos Bancarios</legend>
            <label for="pais">País</label>
            <input type="text" id="pais" value='ES' disabled class= "campo"/>(sólo válido ES)<br/>
            <label for="iban">Control IBAN:</label>
            <input type="text" id="iban" placeholder="xx" pattern="[0-9]{2}" maxlength="2" class="campo"/>(dos dígitos)<br/>
            <label for='entidad'>Entidad:</label>
            <input type="text" id="entidad" placeholder="xxxx" pattern="[0-9]{4}" maxlength="4" class="campo"/>(cuatro digitos)<br/>
            <label for="sucursal">Sucursal:</label>
            <input type="text" id="sucursal" placeholder="xxxx" pattern="[0-9]{4}" maxlength="4" class= "campo"/>(cuatro dígitos)<br/>
            <label for="dc">DC:</label>
            <input type="text" id="dc" placeholder="xx" pattern="[0-9]{2}" maxlength="2" class="campo"/>(dos dígitos)<br/>
            <label for="cuenta">Cuenta:</label>
            <input type="text" id="cuenta" placeholder="xxxxxxxxxx" pattern="[0-10]{10}" maxlength="10" class= "campo" value=""/>(diez dígitos)<br/>
        </fieldset>
        <fieldset class= "fieldset">
            <legend class= "legend">Datos Estadisticos - Como nos conocio? </legend>
            <input type="checkbox" name= "datos estadisticos"> A traves de la tv  </br>
            <input type="checkbox" name= "datos estadisticos"> A traves de la radio </br>
            <input type="checkbox" name= "datos estadisticos"> A traves de internet </br>
            <input type="checkbox" name= "datos estadisticos"> Otros 
            <input type="range" id= "rango" min="1" max= "5" value= ""/> Valoracion [1-5]</br>
            <p>Fecha de la Encuesta <input type="date" id="fecha"  value="2019-01-01" > Valoracion [1-5]</p>
        </fieldset>
        <input type="button" id= "check" value= "Enviar Datos"  onclick="validacion()">
        <input type="reset" value= "Borrar Datos" > <br/>
        <button type="button"  class= alerta id= "valoracion" onclick="alertavaloracion(rango)"> Mostrar Valoracion </button>
        <button type= "button" class= alerta id= "cuentabancaria" onclick= "alertacuenta (iban + entidad + sucursal + dc + cuenta )">Mostrar Cuenta</button>
        <button type="button" class= alerta value="Mostrar Día Semana" onclick="alertaDiaDeSemana(fecha)" >Mostrar Dia Semana</button>
    </form>
    <script>
    
    
    const cp_provincias = { 01: "Alava", 02: "Albacete" , 03: "Alicante", 04: "Almeria", 05: "Avila", 06: "Badajoz",
    07: "Islas Baleares", 08: "Barcelona", 09: "Burgos", 10: "Caceres", 11: "Cadiz", 12: "Castellon", 
    13: "Ciudad Real", 14: "Cordoba", 15: "La Coruña", 16: "Cuenca", 17: "Gerona", 18: "Granada", 
    19: "Guadalajara", 20: "Giupuzcoa", 21: "Huelva", 22: "Huesca", 23: "Jaen", 24:"Leon" , 25:  "Lerida", 
    26: "La Rioja", 27: "Lugo", 28: "Madrid", 29: "Malaga", 30: "Murcia", 31: "Navarra", 32: "Orense", 
    33: "Asturias", 34: "Palencia", 35:"Las Palmas", 36: "Pontevedra", 37: "Salamanca", 
    38:"Santa Cruz de Tenerife", 39: "Cantabria", 40: "Segovia", 41: "Sevilla", 42: "Soria", 43: "Tarragona", 
    44: "Teruel", 45: "Toledo", 46: "Valencia", 47: "Valladolid", 48:"Vizcaya", 49:"Zamora" , 50: "Zaragoza", 
    51: "Ceuta"};  
    function validacion(cpostal) {
        var codigopostal = document.getElementById("codigopostal").value;
        console.log(codigopostal);
        
        var provIngresada = document.getElementById("provincia").value;
        var campoProv = document.getElementById("provincia");
        var validoProv = document.getElementById("salidaprovincia");
        console.log(provIngresada);

        var formulario= document.getElementById("form");
        
        pattern = new RegExp ('^[0-9]+$');
        patternPROV= new RegExp('[A-Z]+$', 'i');
        

        if (codigopostal ==  "" || codigopostal == "  ") { 
            alert ("El campo Codigo postal no puede quedar vacio");
        } 
        else if(codigopostal.length < 5)  {
            alert ("El campo codigo postal debe tener 5 numeros");
        }
        else if (!pattern.test(codigopostal)) {
            alert ("Ingrese solo numeros en el campo Código Postal");
        } 
        else if (codigopostal == 00000 || codigopostal > 52999) {
             alert ("El Codigo Postal es inexistente");
        }
        else if (!patternPROV.test(provIngresada)) {
            alert ("Solo ingrese letras en el campo Provincia. Este campo no puede quedar vacio");
        } 
        else {

        var cpABuscar;
        if (codigopostal >= 1000 && codigopostal <= 52999) {
            cpABuscar = String(codigopostal).substring(0,2);
        }
        console.log(cpABuscar);

        var provABuscar = cp_provincias[parseInt(cpABuscar)];
        console.log(provABuscar);

        if (codigopostal.length ==5)
        { if  (provABuscar.toLowerCase() == provIngresada.toLowerCase() )
            {
            validoProv.innerHTML="El CP ingresado COINCIDE con la provincia ingresada  ";
            validoProv.style.color="green";
        } else       
            {
            validoProv.innerHTML=("El CP igresado NO coincide con la provincia ingresada. La provincia correspondiente al CP ingresado es "+provABuscar+" "); 
            validoProv.style.color="red";
        } 
    }
}
}
    
    rango= document.getElementById(rango).value
    function alertavaloracion () {
        alert ("Has valorado con "+rango.value+" puntos ");
    }
    
 
   iban= document.getElementById("iban").value
   entidad= document.getElementById("entidad").value
   sucursal= document.getElementById("sucursal").value
   dc= document.getElementById("dc").value
   cuenta= document.getElementById("cuenta").value
    
    function alertacuenta () {
         alert ("Le informamos que su cuenta bancaria es: ES "+iban.value+" - "+entidad.value+" - "+sucursal.value+" - "+dc.value+" - "+cuenta.value+ " ");
    }


    function alertaDiaDeSemana(){ 
    var d=new Date(document.getElementById("fecha").value);
        d.setDate(d.getDate() );
    var diadesemana=["Lunes","Martes","Miercoles","Jueves","Viernes","Sabado","Domingo"];
    var n= diadesemana[d.getDay()];
    document.getElementById("fecha").innerHTML=n;
        alert("La fecha seleccionada en el elemento de fecha es un "+ n);   
    } 

    </script>
    </body>
    </HTML>